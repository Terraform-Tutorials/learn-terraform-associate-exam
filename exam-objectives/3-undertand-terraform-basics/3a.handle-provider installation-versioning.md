# Handle Terraform and provider installation and versioning

##  Provider Configuration
O Terraform usa providers para suportar a interação com os provedores de cloud como AWS, Azure e outros, SaaS providers e APIs. As configurações do provider pertecem ao módulo root da configuração do Terraform.

```hcl
provider "google" {
  project = "acme-app"
  region  = "us-central1"
}
```

- O nome `google` dentro do provider mostra que é um (local name) desse provedor.
- o corpo de texto dentro das chaves, indicam que são argumentos da coniguração para esse provider, os dois argumentos project e region são argumentos do provedor google.
- O Terraform Registry é o local onde estão todos os provedores utilizados pelo Terraform, com todas as documentações e dados de cada provedor.
- Existem apenas dois meta argumentos que são nativos do bloco do Terraform que são: `alias` e `version`.

## Multiple Provider Configurations
Também é possível de definir multiplas configurações dentro do mesmo provider, podemos adiconar por exemplo várias regiões de um provedor de nuvem como AWS, ou vários hosts dop Docker ou vários hosts do Consul por exemplo.

Veja um exemplo abaixo de múltiplos provider com o Terraform. Vale detalhes que  devemos sempre usar `alias`.

```hcl
# The default provider configuration; resources that begin with `aws_` will use
# it as the default, and it can be referenced as `aws`.
provider "aws" {
  region = "us-east-1"
}

# Additional provider configuration for west coast region; resources can
# reference this as `aws.west`.
provider "aws" {
  alias  = "west"
  region = "us-west-2"
}
```

Para modulos do Terraform, devemos seguir com a documentação do Terraform, que pede para em casos de uso com módulos e vários provedores dentro do Terraform, devemos seguir com o argumento `configuration_aliases` dentro de `required_providers` como esta abaixo:

```hcl
terraform {
  required_providers {
    mycloud = {
      source  = "mycorp/mycloud"
      version = "~> 1.0"
      configuration_aliases = [ mycloud.alternate ]
    }
  }
}
```
## Selecting Alternate Provider Configurations
Por default, os recursos do Terraform usam as configuracoes padroes de cada provide (sem o `alias`), caso voce esteja querendo usar um provider alternativo, deve-se passar o argumento dentro do campo do `resource` como abaixo:

```hcl
resource "aws_instance" "foo" {
  provider = aws.west

  # ...
}
```

Para uso dentro de modulos usamos da seguinte forma:

```hcl
module "aws_vpc" {
  source = "./aws_vpc"
  providers = {
    aws = aws.west
  }
}
```